{"paragraphs":[{"user":"jjparrad@dis.eafit.edu.co","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605736358359_517823119","id":"20201118-215238_559792944","dateCreated":"2020-11-18T21:52:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:392","text":"%spark2.pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions as f\nfrom pyspark.sql.types import StringType,DoubleType,IntegerType\nspark=SparkSession.builder.appName('data_processing').getOrCreate()\ndf=spark.read.csv(\"hdfs:/user/jjparrad/datasets/otros/datapeliculas.csv\",inferSchema=True,header=True)","dateUpdated":"2020-11-18T22:39:11+0000","dateFinished":"2020-11-18T22:39:12+0000","dateStarted":"2020-11-18T22:39:11+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=94","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=95"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n# Punto 1\ndf.groupBy(\"Usuario\").agg(f.mean(\"Rating\"),f.count(\"Usuario\")).show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T22:39:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605736419251_1989122060","id":"20201118-215339_663004946","dateCreated":"2020-11-18T21:53:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:565","dateFinished":"2020-11-18T22:39:29+0000","dateStarted":"2020-11-18T22:39:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+--------------+\n|Usuario|avg(Rating)|count(Usuario)|\n+-------+-----------+--------------+\n|    115|        2.0|             1|\n|    210|        3.0|             1|\n|    253|        5.0|             1|\n|     22|        1.0|             1|\n|    122|        5.0|             1|\n|    225|        4.0|             1|\n|    305|        3.0|             1|\n|    291|        3.0|             2|\n|      6|        3.0|             1|\n|    308|        4.0|             1|\n|    299|        4.0|             1|\n|    286|        5.0|             1|\n|    196|        3.5|             2|\n|    290|        4.0|             1|\n|    301|        4.0|             1|\n|    278|        5.0|             1|\n|      7|        4.0|             1|\n|    244|       3.25|             4|\n|    194|        2.0|             1|\n|    166|        1.0|             1|\n+-------+-----------+--------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=96","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=97","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=98","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=99"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n# Puntos 2 y 3\ndf.groupBy(\"Date\").count().show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T22:58:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605736726198_1661266698","id":"20201118-215846_541114956","dateCreated":"2020-11-18T21:58:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:656","dateFinished":"2020-11-18T22:55:14+0000","dateStarted":"2020-11-18T22:55:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-----+\n|               Date|count|\n+-------------------+-----+\n|2014-03-22 00:00:00|    6|\n|2014-03-25 00:00:00|   10|\n|2014-03-23 00:00:00|    5|\n|2014-03-20 00:00:00|   11|\n|2014-03-21 00:00:00|    5|\n|2014-03-24 00:00:00|    8|\n+-------------------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=144","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=145","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=146","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=147","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=148"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n# Punto 4\ndf.groupBy(\"Movie\").agg(f.count(\"Movie\"), f.mean(\"Rating\")).show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T22:58:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605739247594_-2054073564","id":"20201118-224047_1271881170","dateCreated":"2020-11-18T22:40:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2153","dateFinished":"2020-11-18T22:58:34+0000","dateStarted":"2020-11-18T22:58:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+------------+-----------+\n|Movie|count(Movie)|avg(Rating)|\n+-----+------------+-----------+\n|  392|           1|        4.0|\n|  451|           1|        3.0|\n|  193|           1|        4.0|\n|  796|           1|        1.0|\n|  222|           1|        5.0|\n|  346|           1|        1.0|\n|  246|           1|        3.0|\n|  603|           1|        5.0|\n|    1|           1|        4.0|\n|  768|           1|        2.0|\n|  274|           2|        3.0|\n|  474|           1|        4.0|\n|   86|           1|        3.0|\n|   16|           1|        4.0|\n|   40|           1|        3.0|\n|  377|           1|        1.0|\n|  257|           1|        2.0|\n|  327|           1|        5.0|\n|  486|           1|        4.0|\n|   88|           1|        4.0|\n+-----+------------+-----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=158","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=159","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=160","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=161"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n# Puntos 5 y 6\ndf.groupBy(\"Date\").mean(\"Rating\").show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T22:58:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605739831154_1874234782","id":"20201118-225031_1934984843","dateCreated":"2020-11-18T22:50:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2572","dateFinished":"2020-11-18T22:56:54+0000","dateStarted":"2020-11-18T22:56:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------------+\n|               Date|       avg(Rating)|\n+-------------------+------------------+\n|2014-03-22 00:00:00|               3.5|\n|2014-03-25 00:00:00|               3.3|\n|2014-03-23 00:00:00|               3.4|\n|2014-03-20 00:00:00|2.6363636363636362|\n|2014-03-21 00:00:00|               3.8|\n|2014-03-24 00:00:00|             3.625|\n+-------------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=153","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=154","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=155","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=156","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=157"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n# Punto 7\ndf.groupBy(\"Genre\").max(\"Rating\").show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T23:20:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605740197280_-867590244","id":"20201118-225637_1483270998","dateCreated":"2020-11-18T22:56:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3079","dateFinished":"2020-11-18T23:20:01+0000","dateStarted":"2020-11-18T23:20:01+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------+\n|   Genre|max(Rating)|\n+--------+-----------+\n|religion|          4|\n|suspenso|          5|\n|deportes|          4|\n|  accion|          5|\n+--------+-----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=218","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=219","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=220","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=221","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=222"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\ndf.show()","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T23:07:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605740360079_-351946334","id":"20201118-225920_1881455375","dateCreated":"2020-11-18T22:59:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3364","dateFinished":"2020-11-18T23:07:50+0000","dateStarted":"2020-11-18T23:07:49+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+------+--------+-------------------+\n|Usuario|Movie|Rating|   Genre|               Date|\n+-------+-----+------+--------+-------------------+\n|    196|  304|     3|suspenso|2014-03-20 00:00:00|\n|    186|  302|     3|  accion|2014-03-20 00:00:00|\n|     22|  377|     1|suspenso|2014-03-20 00:00:00|\n|    244|   51|     2|  accion|2014-03-20 00:00:00|\n|    166|  346|     1|  accion|2014-03-20 00:00:00|\n|    298|  474|     4|  accion|2014-03-20 00:00:00|\n|    115|  265|     2|  accion|2014-03-20 00:00:00|\n|    253|  465|     5|  accion|2014-03-20 00:00:00|\n|    305|  451|     3|  accion|2014-03-20 00:00:00|\n|      6|   86|     3|religion|2014-03-20 00:00:00|\n|     62|  257|     2|  accion|2014-03-20 00:00:00|\n|    286|  304|     5|suspenso|2014-03-21 00:00:00|\n|    200|  222|     5|suspenso|2014-03-21 00:00:00|\n|    210|   40|     3|  accion|2014-03-21 00:00:00|\n|    244|   29|     3|  accion|2014-03-21 00:00:00|\n|    303|  785|     3|  accion|2014-03-21 00:00:00|\n|    122|  387|     5|  accion|2014-03-22 00:00:00|\n|    194|  274|     2|deportes|2014-03-22 00:00:00|\n|    291| 1042|     4|  accion|2014-03-22 00:00:00|\n|    234| 1184|     2|  accion|2014-03-22 00:00:00|\n+-------+-----+------+--------+-------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=184"],"interpreterSettingId":"spark2"}}},{"text":"%spark2.pyspark\n","user":"jjparrad@dis.eafit.edu.co","dateUpdated":"2020-11-18T23:07:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605740869950_165939600","id":"20201118-230749_333089247","dateCreated":"2020-11-18T23:07:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3755"}],"name":"nota2","id":"2FPUGRKCM","noteParams":{},"noteForms":{},"angularObjects":{"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}